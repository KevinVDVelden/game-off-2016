/*******************************************
 *** Configuration
 ******************************************/
@ROOM_HEIGHT: 250px;
@ROOM_WIDTH: 200px;

@ROOM_CEILING_HEIGHT: 40px;
@ROOM_FLOOR_HEIGHT: 60px;

@DARK_BACKGROUND: #222;
@DARK_BACKGROUND_TEXT: #DDD;
@LIGHT_BACKGROUND: #888;
@LIGHT_BACKGROUND_TEXT: #000;

/*******************************************
 *** Helper mixins
 ******************************************/
.attention_bar() {
    background: @DARK_BACKGROUND;
    color: @DARK_BACKGROUND_TEXT;
    border-radius: 5px;
    padding: 5px;
}
.attention_bar_button() {
    background: @LIGHT_BACKGROUND;
    color: @LIGHT_BACKGROUND_TEXT;
    border-radius: 5px;
    padding: 5px;
}

/*******************************************
 *** Room style helper
 ******************************************/
.base_roomtype_color( @type, @color ) {
    .room_@{type} {
        .room_ceiling {
            background: lighten( @color, 5% );
        }
        .room_floor {
            background: darken( @color, 10% );
        }
        .room_content {
            background: @color;
        }
    }
}
.base_roomtype_perspective_sub( @which, @color, @background, @degree ) {
    .room_@{which} when ( @degree < 0 ) and ( isstring( @background ) ) {
        top: -20px;
        transform: rotateX( @degree );
    }
    .room_@{which} when ( @degree > 0 ) and ( isstring( @background ) ) {
        bottom: -20px;
        transform: rotateX( @degree );
    }

    .room_@{which} when ( isstring( @background ) ) {
        background: url( @background );

        position: absolute;
        z-index: 0;

        width: 100%;
        height: 200px;
    }
}
.base_roomtype_perspective( @type, @color, @floor, @ceiling ) {
    .base_roomtype_color( @type, @color );

    .room_@{type} {
        perspective: 200px;
        overflow: hidden;

        .base_roomtype_perspective_sub( ceiling, @color, @ceiling, -75deg );
        .base_roomtype_perspective_sub( floor, @color, @floor, 75deg );

        .room_content {
            height: @ROOM_HEIGHT - @ROOM_CEILING_HEIGHT - @ROOM_FLOOR_HEIGHT;
            width: 100%;

            position: absolute;
            top: @ROOM_CEILING_HEIGHT;
            z-index: 1;
        }
    }
}

/*******************************************
 *** Room styles
 ******************************************/
.base_roomtype_perspective( conversion, #777, '/assets/dark_wood_floor.png', '/assets/lab_ceiling.png' );
.base_roomtype_perspective( research, #444, '/assets/wood_floor.png', '/assets/lab_ceiling.png' );

.base_roomtype_perspective( outside, #87CEEB, '/assets/dark_wood_floor.png', -1 );
.base_roomtype_perspective( outside_door, #87CEEB, '/assets/dark_wood_floor.png', -1 );
.room_outside .room_ceiling, .room_outside_door .room_ceiling {
    background: linear-gradient( darken( #87CEEB, 10% ), #87CEEB );
}
.room_outside .room_content, .room_outside_door .room_content {
    background: linear-gradient( #87CEEB, lighten( #87CEEB, 10% ) );
}

.room_conversion .room_floor, .room_research .room_floor, .room_outside .room_floor, .room_outside_door .room_floor {
    background-size: 64px;
}

body {
    margin-top: 50px;
}

.room_level {
    height: @ROOM_HEIGHT;
    margin: auto;
    background: #222;
    position: relative;
}

/*******************************************
 *** Base room styling and perspective
 ******************************************/
.room {
    height: @ROOM_HEIGHT;
    position: absolute;
}
.room_ceiling, .room_floor {
    position: absolute;
}
.room_ceiling {
    height: @ROOM_CEILING_HEIGHT;
    position: absolute;
    width: 100%;
}
.room_content {
    height: @ROOM_HEIGHT - @ROOM_CEILING_HEIGHT - @ROOM_FLOOR_HEIGHT;
}

/*******************************************
 *** Build different sized rooms
 ******************************************/
.build_room_sizes(@counter) when (@counter >= 0) {
    .build_room_sizes((@counter - 1));

    .room_size_@{counter} when (@counter > 0) { width: @ROOM_WIDTH * (@counter); }
    .room_level_size_@{counter} when (@counter > 0) { width: @ROOM_WIDTH * (@counter); }
    .room_offset_@{counter} { left: @ROOM_WIDTH * @counter; }
}
.build_room_sizes( 8 );

/*******************************************
 *** Resources
 ******************************************/

#resource_listing {
    float: right;
    margin-top: -40px;
    text-align: right;

    ul {
        .attention_bar();
        list-style-type: none;
        margin: 0;

        li {
            display: inline;
            margin-right: 10px;
        }
    }
}

/*******************************************
 *** Characters
 ******************************************/
.character {
    position: relative;
    width: 32px;
    height: 32px;
    display: inline-block;

    img {
        position: absolute;
        top: 0;
        left: 0;
    }
}

/*******************************************
 *** Machines
 ******************************************/
.build_machine_offsets(@counter) when (@counter >= 0) {
    .build_machine_offsets((@counter - 1));

    .machine_offset_@{counter} {
        position: absolute;
    }
}
.build_machine_offsets( 12 );
.machine .character {
    position: absolute;
    left: 48px;
    top: 48px;
}

//Machines that need to have the character rendered *before* the image
.conversion_chamber {
    .character {
        z-index: 0;
    }
    .baseimage {
        z-index: 1;
        position: absolute;
    }
    .overlay {
        z-index: 2;
        position: absolute;
    }
}

/*******************************************
 *** Toolbars
 ******************************************/
.toolbar {
    .attention_bar();
    position: absolute;

    ul {
        list-style-type: none;
        margin: 0;
        padding: 0 0 0 10px;

        li {
            display: inline;
            margin-right: 10px;
        }
    }
}

.machine .toolbar {
    top: -15px;
    left: 20px;
}
